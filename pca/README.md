# PCA Analysis Results

This repository contains the results of **Principal Component Analysis (PCA)** applied to genotype datasets. We retain 90% of the variance in the PCA transformation, and the resulting reduced-dimension dataset is used as input data for the **diffusion model**, aligning with the model's assumption of continuous data transition.

## Repository Structure

PCA is applied to each chromosome, and the following files are saved in each chromosome's folder:

- `explained_variance.png`: A plot showing the explained variance by each principal component.
- `pca_components.npy`: A file containing the principal components (eigenvectors) that retain 90% of the variance.
- `pca_mean.npy`: The mean of the original dataset used for centering the data before PCA.
- `reconstruction_metrics.txt`: A file containing metrics used to evaluate the quality of data reconstruction.

## Reconstructing Data from PCA Space to Original Dataset

The formula for reconstructing the original genotype data for a chromosome from its PCA representation is:

$$
X_{\text{reconstructed}} = X_{\text{transformed}} \cdot W^T + \mu
$$

Where:
- $X_{\text{reconstructed}}$: The reconstructed data in the original feature space.
- $X_{\text{transformed}}$: The data after PCA transformation, i.e., the synthetic data generated by the diffusion model.
- $W$: The matrix of principal components (eigenvectors).
- $\mu$: The mean of the original data, added back to reverse the centering applied during PCA.

Since $X_{\text{reconstructed}}$ is continuous, we discretize it to the nearest integer values (0, 1, or 2) to recover the genotype.

### Example: Reconstructing Genotype

```python
import numpy as np

# Load PCA components and mean
pca_components = np.load("chromosome_path/pca_components.npy")
pca_mean = np.load("chromosome_path/pca_mean.npy")
# Assume 'diffusion_generated_synthetic_data' is the output from the diffusion model in PCA latent space
reconstructed_data = np.dot(diffusion_generated_synthetic_data, pca_components) + pca_mean
# Round to nearest genotype values and clip to valid range [0, 2]
reconstructed_data = np.rint(reconstructed_data).clip(0, 2)